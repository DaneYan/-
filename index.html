<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>毕业</title>
    <link rel="stylesheet" href="animate.css">
    <style type="text/css">
        *{
            margin:0;
            padding: 0;
            font-family: "Microsoft yahei";
        }
        html,body{
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        #main{
            width: 750px;
            height: 1334px;
            position: absolute;
            left:50%;
            top:0;
            margin-left: -375px;
            transform-origin:top;/*设置缩放的基准点是顶端的中心点*/
            -webkit-transform-origin: top;
            background-color: white;
        }
        #main>div{/*把五张图叠起来*/
            width: 100%;
            height: 100%;
            position: absolute;
            top:0;
            left: 0;
            background-color: #0cf93e;
            z-index: 6;
            font-size: 50px;
            transition: 0.5s;
        }
        #main>div.zIndex{
            z-index: 7;
        }
        #main>.five>img{
            display: block;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background-color: #0cf93e;
            position: absolute;
            top: 100px;
            left: 50%;
            margin-left: -100px;
        }
        #main>.five>img:nth-child(2){
            top:275px;
            left: 140px;
        }
        #main>.five>img:nth-child(3){
            top:275px;
            left: 610px;
        }
        #main>.five>img:nth-child(4){
            top:525px;
            left: 245px;
        }
        #main>.five>img:nth-child(5){
            top:525px;
            left: 505px;
        }
    </style>

</head>
<body>
<div id="main">
    <div class="one">1111</div>
    <div class="two" style="background-color: #2c9dc4">22222</div>
    <div class="three" style="background-color: #fffc39">3333</div>
    <div class="four" style="background-color: #c444bd">44444</div>
    <div class="five" style="background-color: #f7f7f7">
        <img src="imgs/circle/1.jpg" alt="" class="animated bounceInDown">
        <img src="imgs/circle/2.jpg" alt="" class="animated bounceInLeft">
        <img src="imgs/circle/3.jpg" alt="" class="animated bounceInRight">
        <img src="imgs/circle/4.jpg" alt="" class="animated bounceInUp">
        <img src="imgs/circle/5.jpg" alt="" class="animated bounceInUp">

    </div>
    <div></div>
    <div></div>
    <div></div>
    <div></div>
    <div></div>
</div>



</body>
</html>

<script src="jquery-1.9.1.js"></script>

<script>
    function getEle(ele) {
        return document.querySelector(ele);
    }
    var main = getEle("#main");

    var winW = document.documentElement.clientWidth;
    var winH = document.documentElement.clientHeight;

    var desW = 750;
    var desH = 1334;
    //适配
    if (winW / winH <= desW / desH) {
        main.style.webkitTransform = "scale(" + winH / desH + ")";
    } else {
        main.style.webkitTransform = "scale(" + winW / desW + ")";
    }


    var $oDvs = $("#main>div");
    //console.log($oDvs);

    //划屏-->touchstart,touchmove,touchend
    // transitionEnd webkitTransitionEnd-->当运动结束的时候,要重置哪些样式;
    slidePage();
    function slidePage(){
        var curIndex = 0;
        var nextprevIndex = 0;
        //touchstart内记录手指的纵坐标(e.originalEvent.changedTouches[0].pageY)，当前是第几屏;


        $oDvs.on("touchstart",function(e){
            var touchStartPageY = e.originalEvent.changedTouches[0].pageY;
            curIndex = $(this).index();
            //console.log(curIndex);


            //touchmove内通过e.originalEvent.changedTouches[0].pageY区分出上划下划
            //所有this的兄弟hide（保证屏幕内最多只出现两个页面），移动则当前这屏缩小和移动，下一屏显示并移动并提高层级
            $oDvs.on("touchmove",function(e){
                $(this).siblings().hide();
                var touchPageY = e.originalEvent.changedTouches[0].pageY;
                var touchDistance = Math.abs(touchPageY-touchStartPageY);//手指移动的距离
                var ratio = 0.25;//系数
                if(touchPageY>touchStartPageY){//down
                    nextprevIndex=curIndex==0?$oDvs.length-1:curIndex-1;
                    $(this).css("transform","translate(0,"+touchDistance*ratio+"px) scale("+(1-touchDistance/winH*ratio)+")");
                    $oDvs.eq(nextprevIndex).show().css('transform','translate(0,'+(-winH+touchDistance)+'px)');
                    $oDvs.eq(nextprevIndex).addClass('zIndex').siblings().removeClass('zIndex');
                    console.log("down");

                }else {//up
                    nextprevIndex=curIndex==$oDvs.length-1?0:curIndex+1;
                    $(this).css("transform","translate(0,"+touchDistance*-ratio+"px) scale("+(1-touchDistance/winH*ratio)+")");
                    $oDvs.eq(nextprevIndex).show().css('transform','translate(0,'+(winH-touchDistance)+'px)');
                    $oDvs.eq(nextprevIndex).addClass('zIndex').siblings().removeClass('zIndex');


                }
                e.preventDefault();

            });

            //touchend内通过e.originalEvent.changedTouches[0].pageY区分出上划下划
            //当前屏到比例终点，下一屏到达0，0位置
            $oDvs.on("touchend",function(e){
                var touchPageY = e.originalEvent.changedTouches[0].pageY;
                var touchDistance = Math.abs(touchPageY-touchStartPageY);//手指移动的距离
                var ratio = 0.25;//系数
                if(touchPageY>touchStartPageY){//down
                    nextprevIndex=curIndex==0?$oDvs.length-1:curIndex-1;
                    ratio = 0.25;
                }else {//up
                    nextprevIndex=curIndex==$oDvs.length-1?0:curIndex+1;
                    ratio = -0.25;
                    console.log("up");
                    /*$oDvs.eq(nextprevIndex).css('transform','translate(0,0)');
                    $(this).css("transform","translate(0,"+touchDistance*-ratio+"px) scale("+(1-ratio)+")");
                    $(this).css('transition','0.3s').eq(nextprevIndex).css('transition','0.3s');*/
                }
                $oDvs.eq(nextprevIndex).css('transform','translate(0,0)');
                $(this).css("transform","translate(0,"+touchDistance*ratio+"px) scale("+(1-Math.abs(ratio))+")");//注意这里的缩放里的ratio需要加绝对值，因为ratio上下是不同的，而都需要缩小
                //e.preventDefault();
            });
        });
    }


    $oDvs.on('transitionEnd webkitTransitionEnd',function(e){
        //事件源处理方式
        if(!$oDvs.is(e.target)) return;
        resetFn();
    });

    function resetFn(){
        //却掉下一个元素的层级,并且让所有兄弟元素隐藏
        $oDvs.eq(nextprevIndex).removeClass('zIndex').siblings().hide();
        //去掉所有的运动
        $oDvs.css('transition','');
        //开关思想
        bBtn=true;
    }



</script>

